
# TODO

- Native UI app allows generated common source
- Native library allows generated common source
- UI apps pass CLI args to main function
- JVM apps option to define JVM args when launching JVM
- JVM UI cli option to log to stdout
- MacOS UI redirect to log file
- Native apps discover `main()` function with or without args, and fix samples
- Validate app main class and entry point names
- Add something like `testing { kotlinTest() }`
- Fix `desktop { }` does not add targets, but for example `jvm { }` does.
- Add `dist --release`
- Add an "app bundle" plugin, which will include other apps as JVM resources
- Split app code signing and notarization into separate tasks
- Fix `.bat` to work from any directory via a link
  - Or replace with binary launcher
- Figure out why `tasks.registering` is broken for embedded JVM task
- Add test for alternate distributions, e.g `noJvm`
- UI app `dist` task should fail on non-mac host machines
- Don't include `.bat` script for non-windows embedded JVM, or replace with binary launcher
- Improve failure for `dist` task when nothing can be built
  - Or, don't add a dist task in this case.
- Use correct target machine for embedded JVM distributions
  - Currently, uses whichever JVM architecture that Gradle decides to use
- Add distribution for each platform for native binary JVM app
  - Can build both macOS distributions on macOS
- Move dependency declarations into library and application blocks
    - UI applications 
- Libraries in this repo should target Java 11?
- Enable CC
- Add `run` task for apps
- Add `install` task for apps
- Support KMP app that targets native + jvm + browser + node
- Use `--launcher` instead of `--add-modules` with `jlink`
- Convert automatic modules to real modules prior to using with `jlink`
- Download service: don't keep the install dir when install action fails
- Native macOS bundle plugin
- Configurable bundle id, app display name, app version
- Handle missing main class or multiple main classes
- Module-info
    - Default module name to top-most package
    - Only export packages that contain public non-internal types
    - Figure out how to enforce for Kotlin JVM compilation
    - Use an artifact transform to extract the module info for dependencies
- Add functional tests for plugins.
    - Customisation
- Refactor `DownloadRepository` to use Gradle exec service when used in a plugin.
- Installer
- Release
  - Upload to Maven central
  - Verify no VCS changes
  - Create git tag
  - Run check
  - Generate Github release
  - Verify usable from Maven central?
  - Release a suite of libraries "atomically"
  - Alpha/Beta/RC releases

### Gradle issues

- Difficult to configure version based on presence of `release` task, in particular when the library is also used by a local plugin 
- Difficult to get the outputs of a local publication, for input to some later stage (eg upload)
- `MapProperty.getting()` does not seem to retain task dependencies
- `@Nested Property<T>` does not seem to retain task dependencies
- Make it easier to use ArtifactCollection from task
- Fix import of `test-apps` - does not seem to be included
- Use version catalog
- "Included build 'x' does not exist" does not give any content, e.g. where is it defined?
- Get the jlink tool for a toolchain
- Add some way to get a dependency on all tasks with a given name in a build
- Add some way to get a dependency on task with given path in a build, where the task may not exist
- Fix `task.flatMap { it.someOutputDir.file("some-file") }` -> does not carry task dependencies
- Awkward to discard property value from Kotlin (set(null) is ambiguous)
- Set property using `Path`.
- Some kind of managed type `Property<T>` or `Provider<T>` that allows deferred configuration (eg `Property<Distribution>`)
- Create a property of managed type (eg `val dist: Distribution`)
- Some way to get `FileCollection` elements as locations or file names (ie without the build dependencies, to generate a manifest, etc.)
- No way to have a generated output directory (eg a task that uses `DownloadRepository` to locate the output)
- Improve error message when settings plugin is applied to project, and vice versa
- Some way to apply concurrent limits across all builds (eg to work around `commonizeNativeDistribution` concurrency issue)
- Some way to map the base name of a Provider<RegularFile>
- Some way to convert a `File`, `Path`, or string path to `RegularFile`
