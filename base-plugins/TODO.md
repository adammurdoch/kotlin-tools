
# TODO

- Native-launcher: build both macOS binaries, do not build on non-macOS machine, default to arm64 on an M1 machine
- Don't include windows launcher script for embedded JVM and native exe JVM apps
- Fix native image for windows
- Don't add a dist task when there is no source for the current target (eg native-launcher on linux)
- Download service: don't keep the install dir when install action fails
- Set JDK to correct architecture somehow?
- Use `jlink` from arm64 toolchain on m1 macOS
- Native app plugin creates distributions for all targets
- Native macOS bundle plugin
- Configurable bundle id, app display name, app version
- Infer the main class for a JVM app
- Configurable target JVM
- Module-info
    - Default module name to top-most package
    - Only export packages that contain public non-internal types
    - Figure out how to enforce for Kotlin JVM compilation
    - Use an artifact transform to extract the module info for dependencies
- Use correct architecture for macOS native binary, embedded JVM and GraalVM native binary output.
    - Bundle native launcher for each platform in the plugins.
- Add some kind `assembleDebug` task to build a single dev target.
- Add functional tests for plugins.
    - Customisation
- Refactor `DownloadRepository` to use Gradle exec service when used in a plugin.
- Kotlin issues:
    - Duplicate symbol error linking native test executable for mpp library when all test source sets defined 
- Gradle issues:
    - Fix import of `test-apps` - does not seem to be included
    - Use version catalog
    - "Included build 'x' does not exist" does not give any content, e.g. where is it defined?
    - Get the jlink tool for a toolchain
    - Add some way to get a dependency on all tasks with a given name in a build
    - Add some way to get a dependency on task with given path in a build, where the task may not exist
    - Fix running `gradlew test-apps:x` (needs leading `:` and error message does not mention this)
    - Fix `task.flatMap { it.someOutputDir.file("some-file") }` -> does not carry task dependencies
    - Awkward to discard property value from Kotlin (set(null) is ambiguous)
    - Set property using `Path`.
    - Some kind of managed type `Property<T>` or `Provider<T>` that allows deferred configuration (eg `Property<Distribution>`)
    - Create a property of managed type (eg `val dist: Distribution`)
    - Some way to get `FileCollection` elements as locations or file names (ie without the build dependencies, to generate a manifest, etc.)
    - No way to have a generated output directory (eg a task that uses `DownloadRepository` to locate the output)
    - Improve error message when settings plugin is applied to project, and vice versa
    - Some way to apply concurrent limits across all builds (eg to work around `commonizeNativeDistribution` concurrency issue)
